schema: '2.0'
stages:
  filter:
    cmd:
    - python scripts/filter.py
    deps:
    - path: assets/docs_issues_eval_raw.jsonl
      md5: ab56fc1828403bffaf163f3c540e473f
      size: 986883
    - path: assets/docs_issues_training_raw.jsonl
      md5: ebd254a77132b9018fdd581e95aef549
      size: 2914279
    - path: scripts/filter.py
      md5: e031bc8e40741f6d83be9d135d260548
      size: 1183
    outs:
    - path: assets/docs_issues_eval.jsonl
      md5: ab56fc1828403bffaf163f3c540e473f
      size: 986883
    - path: assets/docs_issues_training.jsonl
      md5: e046435c8fc9a5dcb762f19a91b38b9b
      size: 474248
  preprocess:
    cmd:
    - python scripts/preprocess.py assets/docs_issues_training.jsonl corpus/docs_issues_training.spacy
    - python scripts/preprocess.py assets/docs_issues_eval.jsonl corpus/docs_issues_eval.spacy
    deps:
    - path: assets/docs_issues_eval.jsonl
      md5: ab56fc1828403bffaf163f3c540e473f
      size: 986883
    - path: assets/docs_issues_training.jsonl
      md5: e046435c8fc9a5dcb762f19a91b38b9b
      size: 474248
    - path: scripts/preprocess.py
      md5: ae11eb327586c4f0ecd08da7686d6f33
      size: 779
    outs:
    - path: corpus/docs_issues_eval.spacy
      md5: aa66fd3cd54021ce18c231cc27c7fa64
      size: 376708
    - path: corpus/docs_issues_training.spacy
      md5: e79236f04472e150408b804bf05d43e6
      size: 202580
  train-model-2:
    cmd:
    - python -m spacy train configs/config_2.cfg --output training/model_2 --paths.train
      corpus/docs_issues_training.spacy --paths.dev corpus/docs_issues_eval.spacy
      --gpu-id -1
    - rm -rf training/model_2/model-last
    deps:
    - path: configs/config_2.cfg
      md5: 98f448a23895c1b58c60c8e00872345c
      size: 2933
    - path: corpus/docs_issues_eval.spacy
      md5: aa66fd3cd54021ce18c231cc27c7fa64
      size: 376708
    - path: corpus/docs_issues_training.spacy
      md5: e79236f04472e150408b804bf05d43e6
      size: 202580
    outs:
    - path: training/model_2/model-best
      md5: b820886ff65590106b948b882ade488e.dir
      size: 5247282
      nfiles: 12
  train-model-1:
    cmd:
    - python -m spacy train configs/config_1.cfg --output training/model_1 --paths.train
      corpus/docs_issues_training.spacy --paths.dev corpus/docs_issues_eval.spacy
      --gpu-id -1
    - rm -rf training/model_1/model-last
    deps:
    - path: configs/config_1.cfg
      md5: 95789dca5dd651e83a470b13c58c3016
      size: 2931
    - path: corpus/docs_issues_eval.spacy
      md5: aa66fd3cd54021ce18c231cc27c7fa64
      size: 376708
    - path: corpus/docs_issues_training.spacy
      md5: e79236f04472e150408b804bf05d43e6
      size: 202580
    outs:
    - path: training/model_1/model-best
      md5: b252b9bf6861aa9c543dc031b36309bf.dir
      size: 5247279
      nfiles: 12
  evaluate:
    cmd:
    - python -m spacy evaluate training/model_1/model-best corpus/docs_issues_eval.spacy
      --output training/model_1/metrics.json --gpu-id -1
    - python -m spacy evaluate training/model_2/model-best corpus/docs_issues_eval.spacy
      --output training/model_2/metrics.json --gpu-id -1
    deps:
    - path: corpus/docs_issues_eval.spacy
      md5: aa66fd3cd54021ce18c231cc27c7fa64
      size: 376708
    - path: training/model_1/model-best
      md5: b252b9bf6861aa9c543dc031b36309bf.dir
      size: 5247279
      nfiles: 12
    - path: training/model_2/model-best
      md5: b820886ff65590106b948b882ade488e.dir
      size: 5247282
      nfiles: 12
    outs:
    - path: training/model_1/metrics.json
      md5: 562390e1a704e8fef3daf5ff1348fe6f
      size: 569
    - path: training/model_2/metrics.json
      md5: 036ec5b891542cb12e869cc2dd050f4e
      size: 569
